#!/usr/bin/env python
# _*_ coding: utf-8 _*_

import numpy as np
import pandas as pd
import base64

## secret key ##################################################################
CBzeXMuZXhpdChhcHAuZXhlY18o="""#################################################
Y2xhc3MgTWFya3ZDbHVzdGVyKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZGF0YSwgZXhw
YW5kX2ZhY3Rvcj0yLCBpbmZsYXRlX2ZhY3Rvcj0yLjAsIG11bHRfZmFjdG9yPTIuMCwgbWF4X2xvb3A9
MjAwKToKICAgICAgICBzdXBlcihNYXJrdkNsdXN0ZXIsIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBN
ID0gbnAuY29ycmNvZWYoZGF0YSkKICAgICAgICBNW00gPCAwXSA9IDAKICAgICAgICBmb3IgaSBpbiBy
YW5nZShsZW4oTSkpOgogICAgICAgICAgICBNW2ldW2ldID0gMAogICAgICAgIGltcG9ydCBuZXR3b3Jr
eCBhcyBueAogICAgICAgIEcgPSBueC5mcm9tX251bXB5X21hdHJpeChNKQogICAgICAgIHNlbGYuTSwg
c2VsZi5jbHVzdGVycyA9IHNlbGYubmV0d29ya3hfbWNsKEcsIGV4cGFuZF9mYWN0b3I9ZXhwYW5kX2Zh
Y3RvciwgaW5mbGF0ZV9mYWN0b3I9aW5mbGF0ZV9mYWN0b3IsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4X2xvb3A9bWF4X2xvb3AsIG11bHRfZmFjdG9yPW11
bHRfZmFjdG9yKQogICAgICAgIHNlbGYuY2x1c3Rlcl9hcnJheSA9IHNlbGYuZ2V0X2FycmF5KCkKCiAg
ICBkZWYgZ2V0X2FycmF5KHNlbGYpOgogICAgICAgIGFycmF5ID0gW10KICAgICAgICBmb3Iga2V5IGlu
IHNlbGYuY2x1c3RlcnM6CiAgICAgICAgICAgIGZvciB2YWx1ZSBpbiBzZWxmLmNsdXN0ZXJzW2tleV06
CiAgICAgICAgICAgICAgICBhcnJheS5hcHBlbmQoW3ZhbHVlLCBrZXldKQogICAgICAgIGRmID0gcGQu
RGF0YUZyYW1lKG5wLmFycmF5KGFycmF5KSwgY29sdW1ucz1bJ1NhbXBsZScsICdDbHVzdGVyJ10pCiAg
ICAgICAgZGYgPSBkZi5zb3J0X3ZhbHVlcyhieT0nU2FtcGxlJywgYXNjZW5kaW5nPVRydWUpCiAgICAg
ICAgcmV0dXJuIGRmLkNsdXN0ZXIudmFsdWVzCgogICAgZGVmIG5ldHdvcmt4X21jbChzZWxmLCBHLCBl
eHBhbmRfZmFjdG9yPTIsIGluZmxhdGVfZmFjdG9yPTIsIG1heF9sb29wPTEwLCBtdWx0X2ZhY3Rvcj0x
KToKICAgICAgICBpbXBvcnQgbmV0d29ya3ggYXMgbngKICAgICAgICBBID0gbnguYWRqYWNlbmN5X21h
dHJpeChHKQogICAgICAgIHJldHVybiBzZWxmLm1jbChucC5hcnJheShBLnRvZGVuc2UoKSksIGV4cGFu
ZF9mYWN0b3IsIGluZmxhdGVfZmFjdG9yLCBtYXhfbG9vcCwgbXVsdF9mYWN0b3IpCgogICAgZGVmIG1j
bChzZWxmLCBNLCBleHBhbmRfZmFjdG9yPTIsIGluZmxhdGVfZmFjdG9yPTIsIG1heF9sb29wPTEwLCBt
dWx0X2ZhY3Rvcj0xKToKICAgICAgICBNID0gc2VsZi5hZGRfZGlhZyhNLCBtdWx0X2ZhY3RvcikKICAg
ICAgICBNID0gc2VsZi5ub3JtYWxpemUoTSkKICAgICAgICBmb3IgaSBpbiByYW5nZShtYXhfbG9vcCk6
CiAgICAgICAgICAgIE0gPSBzZWxmLmluZmxhdGUoTSwgaW5mbGF0ZV9mYWN0b3IpCiAgICAgICAgICAg
IE0gPSBzZWxmLmV4cGFuZChNLCBleHBhbmRfZmFjdG9yKQogICAgICAgICAgICBpZiBzZWxmLnN0b3Ao
TSwgaSk6IGJyZWFrCgogICAgICAgIGNsdXN0ZXJzID0gc2VsZi5nZXRfY2x1c3RlcnMoTSkKICAgICAg
ICByZXR1cm4gTSwgY2x1c3RlcnMKCiAgICBkZWYgYWRkX2RpYWcoc2VsZiwgQSwgbXVsdF9mYWN0b3Ip
OgogICAgICAgIHJldHVybiBBICsgbXVsdF9mYWN0b3IgKiBucC5pZGVudGl0eShBLnNoYXBlWzBdKQoK
ICAgIGRlZiBub3JtYWxpemUoc2VsZiwgQSk6CiAgICAgICAgY29sdW1uX3N1bXMgPSBBLnN1bShheGlz
PTApCiAgICAgICAgbmV3X21hdHJpeCA9IEEgLyBjb2x1bW5fc3Vtc1tucC5uZXdheGlzLCA6XQogICAg
ICAgIHJldHVybiBuZXdfbWF0cml4CgogICAgZGVmIGluZmxhdGUoc2VsZiwgQSwgaW5mbGF0ZV9mYWN0
b3IpOgogICAgICAgIHJldHVybiBzZWxmLm5vcm1hbGl6ZShucC5wb3dlcihBLCBpbmZsYXRlX2ZhY3Rv
cikpCgogICAgZGVmIGV4cGFuZChzZWxmLCBBLCBleHBhbmRfZmFjdG9yKToKICAgICAgICByZXR1cm4g
bnAubGluYWxnLm1hdHJpeF9wb3dlcihBLCBleHBhbmRfZmFjdG9yKQoKICAgIGRlZiBzdG9wKHNlbGYs
IE0sIGkpOgogICAgICAgIGlmIGkgJSA1ID09IDQ6CiAgICAgICAgICAgIG0gPSBucC5tYXgoTSAqKiAy
IC0gTSkgLSBucC5taW4oTSAqKiAyIC0gTSkKICAgICAgICAgICAgaWYgbSA9PSAwOgogICAgICAgICAg
ICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgZ2V0X2NsdXN0ZXJz
KHNlbGYsIEEpOgogICAgICAgIGNsdXN0ZXJzID0gW10KICAgICAgICBmb3IgaSwgciBpbiBlbnVtZXJh
dGUoKEEgPiAwKS50b2xpc3QoKSk6CiAgICAgICAgICAgIGlmIHJbaV06CiAgICAgICAgICAgICAgICBj
bHVzdGVycy5hcHBlbmQoQVtpLCA6XSA+IDApCiAgICAgICAgY2x1c3RfbWFwID0ge30KICAgICAgICBm
b3IgY24sIGMgaW4gZW51bWVyYXRlKGNsdXN0ZXJzKToKICAgICAgICAgICAgZm9yIHggaW4gW2kgZm9y
IGksIHggaW4gZW51bWVyYXRlKGMpIGlmIHhdOgogICAgICAgICAgICAgICAgY2x1c3RfbWFwW2NuXSA9
IGNsdXN0X21hcC5nZXQoY24sIFtdKSArIFt4XQogICAgICAgIHJldHVybiBjbHVzdF9tYXA="""#dKDl
eval(compile(base64.b64decode(CBzeXMuZXhpdChhcHAuZXhlY18o),'<string>','exec'))##

